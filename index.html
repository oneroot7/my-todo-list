<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">    
    <title>ì—…ë¬´ ì¼ì • ê´€ë¦¬</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div id="login-section" style="text-align: center; margin-top: 100px;">
        <h2>ğŸ“… ì—…ë¬´ ì¼ì • ê´€ë¦¬</h2>
        <button onclick="login()" style="padding: 15px 30px; font-size: 1.1rem; cursor: pointer; border-radius: 12px; border: none; background: #4285F4; color: white; font-weight: bold;">
            Google ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸
        </button>
    </div>

    <div id="main-content" class="todo-container" style="display: none;">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <span id="user-info" style="font-size: 0.9rem; color: #666;"></span>
            <button onclick="logout()" style="background: none; border: none; color: #ff4d4d; cursor: pointer; text-decoration: underline;">ë¡œê·¸ì•„ì›ƒ</button>
        </div>
        </div>

    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
      import { getFirestore } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
      // ì¸ì¦ ëª¨ë“ˆ ì¶”ê°€
      import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

      const firebaseConfig = { /* ë³¸ì¸ ì„¤ì •ê°’ ìœ ì§€ */ };
      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);
      const auth = getAuth(app);
      const provider = new GoogleAuthProvider();

      // ì „ì—­ ë³€ìˆ˜ë¡œ í• ë‹¹
      window.db = db;
      window.auth = auth;
      window.provider = provider;
      window.signInWithPopup = signInWithPopup;
      window.signOut = signOut;

      // ë¡œê·¸ì¸ ìƒíƒœ ê°ì‹œ
      onAuthStateChanged(auth, (user) => {
          if (user) {
              document.getElementById('login-section').style.display = 'none';
              document.getElementById('main-content').style.display = 'block';
              document.getElementById('user-info').innerText = `${user.displayName}ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤.`;
              displaySchedules(true); // ë¡œê·¸ì¸ ì„±ê³µ ì‹œ ë¦¬ìŠ¤íŠ¸ ë¶ˆëŸ¬ì˜¤ê¸°
          } else {
              document.getElementById('login-section').style.display = 'block';
              document.getElementById('main-content').style.display = 'none';
          }
      });
    </script>    
    <div class="todo-container">
        <h2>ğŸ“… ì¼ì • ë“±ë¡</h2>
        <div class="input-form">
            <label>ë‚ ì§œ</label>
            <input type="date" id="date">
            
            <label>ì¥ì†Œ</label>
            <input type="text" id="location" placeholder="ì˜ˆ: ë¯¸íŒ…ë£¸ A">
            
            <label>ì¢…ë£Œ ì‹œê°„</label>
            <input type="time" id="end-time" value="18:00">
            
            <label>íŒ€ ë™ë£Œ</label>
            <input type="text" id="teammates" placeholder="ì˜ˆ: í™ê¸¸ë™, ê¹€ì² ìˆ˜">
            
            <label>ë©”ëª¨</label>
            <textarea id="memo" placeholder="ìƒì„¸ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
            
            <button onclick="addSchedule()">ì¼ì • ì¶”ê°€í•˜ê¸°</button>
        </div>

<hr>
<div class="list-header">
    <h2>ğŸ“‹ ì¼ì • ë¦¬ìŠ¤íŠ¸</h2>
<div class="search-group">
    <input type="text" id="search-input" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥..." oninput="filterSchedules()">
    <button class="view-btn" onclick="displaySchedules(true)">ì „ì²´ ë¦¬ìŠ¤íŠ¸ ë³´ê¸°</button>
</div>
</div>
<ul id="schedule-list"></ul>    </div>
<script type="module">
  // Firebase SDKë“¤
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc, updateDoc, query, orderBy } 
  from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  // 1ë‹¨ê³„ì—ì„œ ë³µì‚¬í•œ ë³¸ì¸ì˜ ì„¤ì •ê°’ì„ ì—¬ê¸°ì— ë„£ìœ¼ì„¸ìš”
  const firebaseConfig = {
  apiKey: "AIzaSyBwPFxAaMFEK07WGeeVUzHb-PfBGeI4gDM",
  authDomain: "my-todo-list-3503a.firebaseapp.com",
  projectId: "my-todo-list-3503a",
  storageBucket: "my-todo-list-3503a.firebasestorage.app",
  messagingSenderId: "215467735362",
  appId: "1:215467735362:web:c6a3091978e3633668f0db",
  measurementId: "G-V7YRZG9FJ6"
};

  // ì´ˆê¸°í™”
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // ì „ì—­ ë³€ìˆ˜ë¡œ ì„¤ì •í•˜ì—¬ script.jsì—ì„œ ì“¸ ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤
  window.db = db;
</script>
<script src="script.js"></script>    
</body>
</html>
