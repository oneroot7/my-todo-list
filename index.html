<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì—…ë¬´ ì¼ì • ê´€ë¦¬ ì‹œìŠ¤í…œ</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="login-section" style="text-align: center; margin-top: 100px; display: none;">
        <div class="login-box" style="display: inline-block; padding: 40px; background: white; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1);">
            <h2 style="margin-bottom: 20px;">ğŸ“… ì¼ì • ê´€ë¦¬ ë¡œê·¸ì¸</h2>
            <p style="color: #666; margin-bottom: 30px;">êµ¬ê¸€ ê³„ì •ìœ¼ë¡œ ì•ˆì „í•˜ê²Œ ì‹œì‘í•˜ì„¸ìš”.</p>
            <button onclick="login()" style="padding: 15px 30px; font-size: 1.1rem; cursor: pointer; border-radius: 12px; border: none; background: #4285F4; color: white; font-weight: bold; width: 100%;">
                Google ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸
            </button>
        </div>
    </div>

    <div id="main-content" class="todo-container" style="display: none;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <span id="user-info" style="font-size: 0.9rem; color: #666; font-weight: bold;"></span>
            <button onclick="logout()" style="background: none; border: none; color: #ff4d4d; cursor: pointer; text-decoration: underline; font-size: 0.9rem;">ë¡œê·¸ì•„ì›ƒ</button>
        </div>

        <div id="calendar-container" class="calendar-card">
            <div class="calendar-header">
                <button onclick="changeMonth(-1)">â—€</button>
                <h3 id="calendar-title"></h3>
                <button onclick="changeMonth(1)">â–¶</button>
            </div>
            <div id="calendar-grid" class="calendar-grid">
                </div>
        </div>

        <h2 id="form-title">ğŸ“… ì¼ì • ë“±ë¡</h2>
        <div class="input-form">
            <label>ë‚ ì§œ</label>
            <input type="date" id="date" readonly style="background-color: #f0f0f0; cursor: not-allowed;" placeholder="ë‹¬ë ¥ì—ì„œ ë‚ ì§œë¥¼ ì„ íƒí•˜ì„¸ìš”">
            
            <label>ì¥ì†Œ</label>
            <input type="text" id="location" placeholder="ì˜ˆ: ë¯¸íŒ…ë£¸ A">
            
            <label>ì¢…ë£Œ ì‹œê°„</label>
            <input type="time" id="end-time" value="18:00">
            
            <label>ì‘ì„±ì</label>
            <input type="text" id="teammates" readonly style="background-color: #f0f0f0; cursor: not-allowed;">
            
            <label>ë©”ëª¨</label>
            <textarea id="memo" placeholder="ìƒì„¸ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
            
            <button onclick="addSchedule()" id="submit-btn">ì¼ì • ì¶”ê°€í•˜ê¸°</button>
        </div>

        <hr style="margin: 40px 0; border: 0; border-top: 1px solid #eee;">

        <div class="list-card">
            <div class="list-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h3 style="margin:0;">ë‚˜ì˜ ì¼ì • ë¦¬ìŠ¤íŠ¸</h3>
                <input type="text" id="list-search" placeholder="ì¥ì†Œ, ë©”ëª¨ ê²€ìƒ‰..." onkeyup="filterList()" 
                       style="width: 200px; padding: 8px; border-radius: 6px; border: 1px solid #ddd; font-size: 0.9rem;">
            </div>
            <ul id="schedule-list"></ul>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        // âš ï¸ ì•„ë˜ firebaseConfigë¥¼ ë³¸ì¸ì˜ Firebase ì½˜ì†” ì„¤ì •ê°’ìœ¼ë¡œ ë°˜ë“œì‹œ êµì²´í•˜ì„¸ìš”!
  const firebaseConfig = {
  apiKey: "AIzaSyBwPFxAaMFEK07WGeeVUzHb-PfBGeI4gDM",
  authDomain: "my-todo-list-3503a.firebaseapp.com",
  projectId: "my-todo-list-3503a",
  storageBucket: "my-todo-list-3503a.firebasestorage.app",
  messagingSenderId: "215467735362",
  appId: "1:215467735362:web:c6a3091978e3633668f0db",
  measurementId: "G-V7YRZG9FJ6"
};

        const app = initializeApp(firebaseConfig);
        
        window.db = getFirestore(app);
        window.auth = getAuth(app);
        window.provider = new GoogleAuthProvider();
        window.signInWithPopup = signInWithPopup;
        window.signOut = signOut;

        // ë¡œê·¸ì¸ ìƒíƒœ ê°ì‹œ ë° UI ì—…ë°ì´íŠ¸
        onAuthStateChanged(window.auth, (user) => {
            const loginSection = document.getElementById('login-section');
            const mainContent = document.getElementById('main-content');
            const userInfo = document.getElementById('user-info');
            const authorInput = document.getElementById('teammates');

            if (user) {
                loginSection.style.display = 'none';
                mainContent.style.display = 'block';
                userInfo.innerText = `${user.displayName}ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤.`;
                
                if (authorInput) {
                    authorInput.value = user.displayName;
                }

                // ë‹¬ë ¥ê³¼ ë¦¬ìŠ¤íŠ¸ ì´ˆê¸°í™”
                if (typeof renderCalendar === 'function') renderCalendar();
                if (typeof displaySchedules === 'function') displaySchedules(true);
            } else {
                loginSection.style.display = 'block';
                mainContent.style.display = 'none';
            }
        });
    </script>

    <script src="script.js"></script>
</body>
</html>
